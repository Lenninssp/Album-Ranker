generator client {
  provider      = "prisma-client-js"
  output        = "../src/generated/prisma"
  binaryTargets = ["native", "rhel-openssl-3.0.x"]
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model Session {
  id           String   @id @default(cuid())
  sessionToken String   @unique
  userId       Int
  user         User     @relation(fields: [userId], references: [id])
  expires      DateTime
}

model User {
  id              Int     @id @default(autoincrement())
  email           String  @unique
  name            String?
  password        String
  imageUrl        String?
  imageStorageKey String?

  passwordUpdatedAt DateTime @default(now())
  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt

  sessions Session[]

  tracks  TrackEdited[]
  albums  AlbumEdited[]
  artists ArtistEdited[]

  following User[] @relation("UserFollows")
  followers User[] @relation("UserFollows")

  interactions     Interaction[]
  UserCreatedTrack UserCreatedTrack[]
}

model TrackEdited {
  id                  Int     @id @default(autoincrement())
  idTrack             String
  idAlbum             String
  idArtist            String
  strTrack            String
  strAlbum            String
  strArtist           String
  strGenre            String?
  strMood             String?
  strStyle            String?
  intDuration         String?
  strDescriptionEN    String?
  strTrackThumb       String?
  strMusicVid         String?
  strMusicVidDirector String?
  strMusicVidCompany  String?
  intMusicVidViews    String?
  intMusicVidLikes    String?
  intTrackNumber      String?
  commentary          String
  tag                 String
  rating              String
  includesMetadata    Boolean @default(true)
  User                User?   @relation(fields: [userId], references: [id])
  userId              Int?
  public              Boolean @default(false)

  interactions Interaction[]

  @@unique([idTrack, userId])
}

model AlbumEdited {
  id               Int           @id @default(autoincrement())
  idAlbum          String
  idArtist         String
  strAlbum         String
  strArtist        String
  intYearReleased  String
  strGenre         String?
  strStyle         String?
  strLabel         String?
  strReleaseFormat String?
  strAlbumThumb    String?
  strAlbumBack     String?
  strAlbumCDart    String?
  strAlbum3DThumb  String?
  strDescriptionEN String?
  strMood          String?
  strSpeed         String?
  strWikipediaID   String?
  commentary       String
  tag              String
  rating           String
  includesMetadata Boolean       @default(true)
  User             User?         @relation(fields: [userId], references: [id])
  userId           Int?
  public           Boolean       @default(false)
  interactions     Interaction[]

  @@unique([idAlbum, userId])
}

model ArtistEdited {
  id                 Int           @id @default(autoincrement())
  idArtist           String
  strArtist          String
  strArtistAlternate String?
  strLabel           String?
  intFormedYear      String?
  strGenre           String?
  strStyle           String?
  strMood            String?
  strCountry         String?
  intMembers         String?
  strWebsite         String?
  strBiographyEN     String?
  strArtistThumb     String?
  strArtistLogo      String?
  strArtistClearart  String?
  strArtistWideThumb String?
  strArtistFanart    String?
  strArtistBanner    String?
  commentary         String
  tag                String
  rating             String
  includesMetadata   Boolean       @default(true)
  User               User?         @relation(fields: [userId], references: [id])
  userId             Int?
  public             Boolean       @default(false)
  interactions       Interaction[]

  @@unique([idArtist, userId])
}

model Interaction {
  id     Int  @id @default(autoincrement())
  userId Int
  user   User @relation(fields: [userId], references: [id])

  trackEditedId Int?
  trackEdited   TrackEdited? @relation(fields: [trackEditedId], references: [id])

  albumEditedId Int?
  albumEdited   AlbumEdited? @relation(fields: [albumEditedId], references: [id])

  artistEditedId Int?
  artistEdited   ArtistEdited? @relation(fields: [artistEditedId], references: [id])

  comment String?
  liked   Boolean @default(false)

  createdAt          DateTime          @default(now())
  UserCreatedTrack   UserCreatedTrack? @relation(fields: [userCreatedTrackId], references: [id])
  userCreatedTrackId Int?

  @@unique([userId, trackEditedId, albumEditedId, artistEditedId])
  @@index([userId])
  @@index([trackEditedId])
  @@index([albumEditedId])
  @@index([artistEditedId])
}

model UserCreatedTrack {
  id     Int  @id @default(autoincrement())
  userId Int
  user   User @relation(fields: [userId], references: [id])

  title       String
  artist      String?
  album       String?
  duration    Int? 
  genre       String?
  mood        String?
  description String?

  rating     String?
  commentary String?
  tag        String?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  public    Boolean  @default(false)

  interactions Interaction[]
}
